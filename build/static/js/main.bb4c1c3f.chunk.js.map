{"version":3,"sources":["services/channels.js","reducers/channelReducer.js","hooks/useChat.jsx","components/ChatRoom.jsx","reducers/userReducer.js","components/CreateRoom.jsx","components/ChannelList.jsx","reducers/mobileReducer.js","components/Navbar.jsx","components/NotFound.jsx","App.jsx","store.js","index.jsx"],"names":["baseUrl","getAll","a","axios","get","response","data","getById","id","create","newChannel","post","updateChannelUsers","users","patch","channelReducer","state","action","type","updatedChannel","messages","changedChannel","newState","map","c","useChat","roomId","useState","me","setMe","stream","setStream","receivingCall","setReceivingCall","caller","setCaller","callerSignal","setCallerSignal","callAccepted","setCallAccepted","idToCall","setIdToCall","callEnded","setCallEnded","name","setName","myVideo","useRef","userVideo","connectionRef","setUsers","socketRef","user","useSelector","activeUser","dispatch","useDispatch","console","log","useEffect","channelService","channel","current","socketClient","query","emit","navigator","mediaDevices","getUserMedia","video","audio","then","userOwnStream","srcObject","on","from","signal","message","newUser","oldUsers","some","u","room","leftUser","filter","oldUser","disconnect","sendMessage","messageContent","content","author","username","date","Date","toLocaleDateString","weekday","year","month","day","hour","minute","crypto","randomBytes","toString","callUser","peer","Peer","initiator","trickle","userToCall","signalData","userStream","answerCall","to","leaveCall","destroy","AlwaysScrollToBottom","elementRef","scrollIntoView","behavior","ref","Message","msg","className","ChatRoom","useParams","setMessage","channels","onSubmit","event","preventDefault","placeholder","value","onChange","target","playsInline","muted","autoPlay","style","width","onClick","logoutUser","window","localStorage","removeItem","userReducer","CreateRoom","newUsername","setNewUsername","roomName","setRoomName","titleClassName","inputFieldClass","buttonClass","setItem","JSON","stringify","loginUser","newChannelData","creator","savedChannel","ChannelList","initialChannels","Array","isArray","mobileReducer","navLink","navLinkMobile","MenuMobileButton","opened","mobileNavOpened","aria-controls","xmlns","height","fill","stroke","viewBox","d","aria-hidden","strokeLinecap","strokeLinejoin","strokeWidth","MobileNavbar","activeClassName","Navbar","NotFound","App","parsedUser","loggedInUser","getItem","parse","initializeUser","exact","path","component","reducer","combineReducers","store","createStore","composeWithDevTools","applyMiddleware","thunk","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.bb4c1c3f.chunk.js","sourcesContent":["import axios from 'axios';\r\n\r\nconst baseUrl = '/api/channels';\r\n\r\n// Fetching all channels from server\r\nconst getAll = async () => {\r\n  const response = await axios.get(baseUrl);\r\n  return response.data;\r\n};\r\n\r\n// Fetch single channel\r\nconst getById = async (id) => {\r\n  const response = await axios.get(`${baseUrl}/${id}`);\r\n  return response.data;\r\n};\r\n\r\n// Creating a new channel\r\nconst create = async (newChannel) => {\r\n  const response = await axios.post(baseUrl, newChannel);\r\n  return response.data;\r\n};\r\n\r\n// Updating a channel\r\nconst updateChannelUsers = async (id, users) => {\r\n  const response = await axios.patch(`${baseUrl}/${id}`, users);\r\n  return response.data;\r\n};\r\n\r\nexport default {\r\n  getAll,\r\n  getById,\r\n  create,\r\n  updateChannelUsers,\r\n};\r\n","/* eslint-disable no-case-declarations */\r\nimport channelService from '../services/channels';\r\n\r\nconst channelReducer = (state = [], action) => {\r\n  switch (action.type) {\r\n  case 'CREATE_CHANNEL':\r\n    return [action.data, ...state];\r\n  case 'UPDATE_MESSAGES':\r\n    const updatedChannel = { ...state, messages: [...state.messages, action.data] };\r\n    return updatedChannel;\r\n  case 'UPDATE_CHANNEL':\r\n    const changedChannel = action.data;\r\n    const newState = state.map((c) => (c.id === changedChannel.id ? changedChannel : c));\r\n    return newState;\r\n  case 'GET_SINGLE_CHANNEL':\r\n    return action.data;\r\n  case 'INIT_CHANNELS':\r\n    return action.data;\r\n  default:\r\n    return state;\r\n  }\r\n};\r\n\r\nexport const getSingleChannel = (id) => async (dispatch) => {\r\n  try {\r\n    const channel = await channelService.getById(id);\r\n    return dispatch({\r\n      type: 'GET_SINGLE_CHANNEL',\r\n      data: channel,\r\n    });\r\n  } catch (err) {\r\n    return console.log('Error fetching single channel', err);\r\n  }\r\n};\r\n\r\nexport const updateChannelMessages = (newMsg) => ({\r\n  type: 'UPDATE_MESSAGES',\r\n  data: newMsg,\r\n});\r\n\r\nexport const updateChannel = (id, users) => async (dispatch) => {\r\n  try {\r\n    const updatedChannel = await channelService.updateChannelUsers(id, users);\r\n    return dispatch({\r\n      type: 'UPDATE_CHANNEL',\r\n      data: updatedChannel,\r\n    });\r\n  } catch (err) {\r\n    return console.log('Error updating a channel', err);\r\n  }\r\n};\r\n\r\nexport const createChannel = (newChannelData) => async (dispatch) => {\r\n  try {\r\n    const savedChannel = await channelService.create(newChannelData);\r\n    return dispatch({\r\n      type: 'CREATE_CHANNEL',\r\n      data: savedChannel,\r\n    });\r\n  } catch (err) {\r\n    return console.log('Error creating a new channel', err);\r\n  }\r\n};\r\n\r\nexport const initializeChannels = () => async (dispatch) => {\r\n  try {\r\n    const initialChannels = await channelService.getAll();\r\n    dispatch({\r\n      type: 'INIT_CHANNELS',\r\n      data: initialChannels,\r\n    });\r\n  } catch (err) {\r\n    console.log('Error initializing posts', err);\r\n  }\r\n};\r\n\r\nexport default channelReducer;\r\n","import { useEffect, useState, useRef } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport socketClient from 'socket.io-client';\r\nimport Peer from 'simple-peer';\r\nimport crypto from 'crypto';\r\nimport { getSingleChannel, updateChannelMessages } from '../reducers/channelReducer';\r\n\r\nconst ENDPOINT = 'http://localhost:3001';\r\n\r\nconst useChat = (roomId) => {\r\n  // ================ VIDEO CHAT, REDO WITH REDUX ========================\r\n  const [me, setMe] = useState('');\r\n  const [stream, setStream] = useState();\r\n  const [receivingCall, setReceivingCall] = useState(false);\r\n  const [caller, setCaller] = useState('');\r\n  const [callerSignal, setCallerSignal] = useState();\r\n  const [callAccepted, setCallAccepted] = useState(false);\r\n  const [idToCall, setIdToCall] = useState('');\r\n  const [callEnded, setCallEnded] = useState(false);\r\n  const [name, setName] = useState('');\r\n\r\n  const myVideo = useRef();\r\n  const userVideo = useRef();\r\n  const connectionRef = useRef();\r\n  // =====================================================================\r\n  const [users, setUsers] = useState([]);\r\n  const socketRef = useRef();\r\n  const user = useSelector((state) => state.activeUser);\r\n  const dispatch = useDispatch();\r\n  console.log('in hook users', users);\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      console.log('useHook no user found');\r\n      return null;\r\n    }\r\n\r\n    // Fetch messages from database on load\r\n    dispatch(getSingleChannel(roomId));\r\n    // Create new socket connection\r\n    socketRef.current = socketClient(ENDPOINT, {\r\n      query: { roomId, user },\r\n    });\r\n    console.log('in use hook');\r\n    console.log('emit', user);\r\n    socketRef.current.emit('userJoinRoom', user);\r\n\r\n    // ============== VIDEO CHAT PART ==============\r\n    // Get the video and audio from user\r\n    navigator.mediaDevices.getUserMedia({ video: true, audio: true })\r\n      .then((userOwnStream) => {\r\n        setStream(userOwnStream);\r\n        myVideo.current.srcObject = stream;\r\n      });\r\n\r\n    // Getting socket id from backend\r\n    socketRef.current.on('socketId', (id) => {\r\n      setMe(id);\r\n    });\r\n\r\n    // Setting states on getting user call\r\n    socketRef.current.on('callUser', (data) => {\r\n      setReceivingCall(true);\r\n      setCaller(data.from);\r\n      setName(data.name);\r\n      setCallerSignal(data.signal);\r\n    });\r\n\r\n    // ==============\r\n\r\n    // Listen for incoming messages\r\n    socketRef.current.on('newChatMessage', (message) => {\r\n      console.log('GETTING NEW MESSAGE', message);\r\n      dispatch(updateChannelMessages(message));\r\n    });\r\n\r\n    // On joining room users in room array adjusted\r\n    socketRef.current.on('userJoinRoom', (newUser) => {\r\n      console.log('joining room is usehook');\r\n      setUsers((oldUsers) => {\r\n        if (oldUsers.some((u) => u.id === newUser.id)) {\r\n          return [...oldUsers];\r\n        }\r\n        return [...oldUsers, newUser];\r\n      });\r\n    });\r\n\r\n    // On user list changes in backend\r\n    socketRef.current.on('roomListChange', (room) => {\r\n      console.log('room list change happened');\r\n      setUsers(() => {\r\n        console.log(room);\r\n        return room.users;\r\n      });\r\n    });\r\n\r\n    // On leaving room users array adjusted accordingly\r\n    socketRef.current.on('userLeaveRoom', (leftUser) => {\r\n      setUsers((oldUsers) => {\r\n        console.log('Old USERS', oldUsers);\r\n        console.log('LEFT USER', leftUser);\r\n        const newUsers = oldUsers.filter((oldUser) => oldUser.id !== leftUser.id);\r\n        return newUsers;\r\n      });\r\n    });\r\n\r\n    // Destroy socket ref when connection is closed\r\n    return () => socketRef.current.disconnect();\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [roomId, user]);\r\n\r\n  // ============= VIDEO CHAT METHODS =============\r\n  const callUser = (id) => {\r\n    const peer = new Peer({\r\n      initiator: true,\r\n      trickle: false,\r\n      stream,\r\n    });\r\n\r\n    // Listening for signals and emiting data from it\r\n    peer.on('signal', (data) => {\r\n      socketRef.current.emit('callUser', {\r\n        userToCall: id,\r\n        signalData: data,\r\n        from: me,\r\n        name,\r\n      });\r\n    });\r\n\r\n    // Setting other user video stream\r\n    peer.on('stream', (userStream) => {\r\n      userVideo.current.srcObject = userStream;\r\n    });\r\n\r\n    socketRef.current.on('callAccepted', (signal) => {\r\n      setCallAccepted(true);\r\n      peer.signal(signal);\r\n    });\r\n\r\n    connectionRef.current = peer;\r\n  };\r\n\r\n  const answerCall = () => {\r\n    setCallAccepted(true);\r\n    const peer = new Peer({\r\n      initiator: false,\r\n      trickle: false,\r\n      stream,\r\n    });\r\n\r\n    peer.on('signal', (data) => {\r\n      socketRef.current.emit('answerCall', {\r\n        signal: data, to: caller,\r\n      });\r\n    });\r\n\r\n    peer.on('stream', (userStream) => {\r\n      userVideo.current.srcObject = userStream;\r\n    });\r\n\r\n    peer.signal(callerSignal);\r\n    connectionRef.current = peer;\r\n  };\r\n\r\n  const leaveCall = () => {\r\n    setCallEnded(true);\r\n    connectionRef.current.destroy();\r\n  };\r\n  // =============\r\n\r\n  // Send a message to the server\r\n  // that forwards it to all users in a room\r\n  const sendMessage = (messageContent) => {\r\n    const options = {\r\n      weekday: 'short', year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit',\r\n    };\r\n    socketRef.current.emit('newChatMessageToServer', {\r\n      content: messageContent,\r\n      author: { username: user.username, id: user.id },\r\n      date: new Date().toLocaleDateString('ru-RU', options),\r\n      id: crypto.randomBytes(12).toString('hex'),\r\n    });\r\n  };\r\n\r\n  return {\r\n    sendMessage,\r\n    users,\r\n    socketRef,\r\n    callUser,\r\n    answerCall,\r\n    leaveCall,\r\n    receivingCall,\r\n    callAccepted,\r\n    idToCall,\r\n    setIdToCall,\r\n    callEnded,\r\n    myVideo,\r\n    userVideo,\r\n    connectionRef,\r\n    stream,\r\n    name,\r\n    setName,\r\n    me,\r\n  };\r\n};\r\n\r\nexport default useChat;\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { useSelector } from 'react-redux';\r\nimport PropTypes from 'prop-types';\r\nimport useChat from '../hooks/useChat';\r\n\r\n// Small element ref at the bottom of chat, so it automatically scrolls to bottom\r\n// when new messages arrive\r\nconst AlwaysScrollToBottom = () => {\r\n  const elementRef = useRef();\r\n  useEffect(() => elementRef.current.scrollIntoView({ behavior: 'smooth' }));\r\n  return <div ref={elementRef} />;\r\n};\r\n\r\nconst Message = ({ user, msg }) => {\r\n  // Tailwindcss styles\r\n  const msgOwn = 'bg-green-200 mx-3 mb-3 p-1 rounded w-52 self-end';\r\n  const msgForeign = 'bg-blue-200 ml-3 mb-3 p-1 rounded w-52 self-start';\r\n  const flexOwn = 'flex flex-row-reverse items-baseline space-x-1';\r\n  const flexForeign = 'flex flex-row items-baseline space-x-1';\r\n\r\n  // Style depends on message's ownership\r\n  // if current user is creator of message => it shows on the right side and with green bg\r\n  // if message is not user's => it's on the left and of color blue\r\n  return (\r\n    <div className={user.id === msg.author.id ? flexOwn : flexForeign}>\r\n      <span className={\r\n        user.id.toString() === msg.author.id.toString() ? msgOwn : msgForeign\r\n      }\r\n      >\r\n        {msg.content}\r\n      </span>\r\n      <span className=\"text-gray-300 text-sm self-start\">\r\n        {msg.date}\r\n      </span>\r\n      { user.id !== msg.author.id\r\n        ? (\r\n          <>\r\n            <br />\r\n            <span className=\"text-gray-500 self-start px-2\">{msg.author.username}</span>\r\n          </>\r\n        ) : null}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ChatRoom = () => {\r\n  const { roomId } = useParams();\r\n  // Getting socket, userlist and message sending function from custom hook\r\n  const {\r\n    sendMessage,\r\n    users,\r\n    callUser,\r\n    answerCall,\r\n    leaveCall,\r\n    callAccepted,\r\n    callEnded,\r\n    idToCall,\r\n    setIdToCall,\r\n    receivingCall,\r\n    myVideo,\r\n    userVideo,\r\n    stream,\r\n    name,\r\n    setName,\r\n    me,\r\n  } = useChat(roomId);\r\n  // Controlling the form\r\n  const [message, setMessage] = useState('');\r\n  // Getting state from redux store\r\n  const user = useSelector((state) => state.activeUser);\r\n  const messages = useSelector((state) => state.channels.messages);\r\n  // Tailwindcss styles\r\n  const inputFieldClass = 'w-5/6 rounded-bl shadow-sm border-r-0 border-t-0 border-gray-400 hover:bg-gray-100 hover:border-gray-500';\r\n  const buttonClass = 'w-1/6 focus:ring-2 shadow-sm px-3 py-2 border border-t-0 border-gray-400 hover:border-gray-500 rounded-br font-semibold focus:outline-none hover:bg-green-200 focus:bg-green-300';\r\n\r\n  const handleMessageSend = (event) => {\r\n    event.preventDefault();\r\n    sendMessage(message);\r\n    setMessage('');\r\n  };\r\n\r\n  if (!user) {\r\n    console.log('no user');\r\n    return (\r\n      <div className=\"text-center\">\r\n        <h1 className=\"font-bold text-xl mt-3\">Please login to see chat!</h1>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"md:grid md:grid-cols-5\">\r\n      <div className=\"mx-3 md:col-start-2 md:col-span-3 shadow-sm border rounded px-5 py-3 mt-5 text-center\">\r\n        <h1 className=\"font-bold text-xl mb-2\">\r\n          Room:\r\n          {' '}\r\n          #\r\n          {roomId}\r\n        </h1>\r\n        <div className=\"md:grid md:grid-cols-4\">\r\n          <div className=\"col-span-1 pt-2 col-start-1 bg-blue-100 rounded-t md:rounded-tr-none border border-gray-400\">\r\n            <h2 className=\"font-semibold\">\r\n              Users in room:\r\n            </h2>\r\n            <ul>\r\n              {users.map((u) => <li key={u.id}>{u.username}</li>)}\r\n            </ul>\r\n          </div>\r\n          <div className=\"col-span-3 col-start-2 border border-gray-400 md:rounded-tr pt-2 md:border-l-0\">\r\n            <h2 className=\"font-semibold text-lg\">\r\n              Chat\r\n            </h2>\r\n            <div className=\"h-80 overflow-auto\">\r\n              <ul className=\"flex flex-col items-baseline\">\r\n                {\r\n                  messages\r\n                    ? (\r\n                      <>\r\n                        {messages.map((msg) => (\r\n                          <li\r\n                            key={msg.id}\r\n                            className={user.id === msg.author.id ? 'self-end items-baseline' : 'self-start items-baseline'}\r\n                          >\r\n                            <Message user={user} msg={msg} />\r\n                          </li>\r\n                        ))}\r\n                      </>\r\n                    )\r\n                    : ('No messages yet..')\r\n                }\r\n                <AlwaysScrollToBottom />\r\n              </ul>\r\n            </div>\r\n          </div>\r\n          <form className=\"md:col-span-4\" onSubmit={handleMessageSend}>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Send a message...\"\r\n              value={message}\r\n              onChange={({ target }) => setMessage(target.value)}\r\n              className={inputFieldClass}\r\n            />\r\n            <button\r\n              type=\"submit\"\r\n              className={buttonClass}\r\n            >\r\n              Send\r\n            </button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n      <div className=\"col-span-5\">\r\n        <div className=\"video-container\">\r\n          {/* User's own video */}\r\n          <div className=\"video\">\r\n            {stream && <video playsInline muted ref={myVideo} autoPlay style={{ width: '300px' }} />}\r\n          </div>\r\n          {/* Another user's video */}\r\n          <div className=\"video\">\r\n            {callAccepted && !callEnded\r\n            // eslint-disable-next-line jsx-a11y/media-has-caption\r\n              ? <video playsInline ref={userVideo} autoPlay style={{ width: '300px' }} />\r\n              : null}\r\n          </div>\r\n        </div>\r\n        <div className=\"myId\">\r\n          Set your name here:\r\n          <br />\r\n          <input\r\n            type=\"text\"\r\n            value={name}\r\n            onChange={({ target }) => setName(target.value)}\r\n          />\r\n          <br />\r\n          Copy your id:\r\n          {' '}\r\n          {me}\r\n          <br />\r\n          Who you want to call by id:\r\n          <br />\r\n          <input\r\n            type=\"text\"\r\n            value={idToCall}\r\n            onChange={({ target }) => setIdToCall(target.value)}\r\n          />\r\n          <br />\r\n          {\r\n            callAccepted && !callEnded\r\n              ? (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={leaveCall}\r\n                >\r\n                  End Call\r\n                </button>\r\n              ) : (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => callUser(idToCall)}\r\n                >\r\n                  Call\r\n                  {' '}\r\n                  {idToCall}\r\n                </button>\r\n              )\r\n          }\r\n        </div>\r\n        <div>\r\n          {\r\n            receivingCall && !callAccepted\r\n              ? (\r\n                <div>\r\n                  <h2>\r\n                    {name}\r\n                    {' '}\r\n                    is calling...\r\n                  </h2>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={answerCall}\r\n                  >\r\n                    Answer\r\n                  </button>\r\n                </div>\r\n              ) : null\r\n          }\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nMessage.propTypes = {\r\n  user: PropTypes.shape({\r\n    username: PropTypes.string,\r\n    id: PropTypes.string,\r\n  }).isRequired,\r\n  msg: PropTypes.shape({\r\n    author: PropTypes.shape({\r\n      username: PropTypes.string,\r\n      id: PropTypes.string,\r\n    }),\r\n    content: PropTypes.string.isRequired,\r\n    date: PropTypes.string.isRequired,\r\n    id: PropTypes.string,\r\n  }).isRequired,\r\n};\r\n\r\nexport default ChatRoom;\r\n","import crypto from 'crypto';\r\n\r\nconst userReducer = (state = null, action) => {\r\n  switch (action.type) {\r\n  case 'INIT_USER':\r\n    return action.data.user;\r\n  case 'LOGIN_USER':\r\n    return action.data.user;\r\n  case 'REMOVE_USER':\r\n    return null;\r\n  default:\r\n    return state;\r\n  }\r\n};\r\n\r\nexport const loginUser = (username) => {\r\n  const id = crypto.randomBytes(12).toString('hex');\r\n  const user = { username, id };\r\n  window.localStorage.setItem('chatAppUser', JSON.stringify(user));\r\n  return {\r\n    type: 'LOGIN_USER',\r\n    data: {\r\n      user,\r\n    },\r\n  };\r\n};\r\n\r\nexport const logoutUser = () => {\r\n  window.localStorage.removeItem('chatAppUser');\r\n  console.log('logged out');\r\n  return {\r\n    type: 'REMOVE_USER',\r\n  };\r\n};\r\n\r\nexport const initializeUser = () => {\r\n  const loggedInUser = window.localStorage.getItem('chatAppUser');\r\n  console.log('to parse:', loggedInUser);\r\n  let parsedUser;\r\n  if (loggedInUser) {\r\n    parsedUser = JSON.parse(loggedInUser);\r\n    console.log('Found logged in user:', parsedUser);\r\n  }\r\n  return {\r\n    type: 'INIT_USER',\r\n    data: {\r\n      user: parsedUser || null,\r\n    },\r\n  };\r\n};\r\n\r\nexport default userReducer;\r\n","import React, { useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { loginUser, logoutUser } from '../reducers/userReducer';\r\nimport { createChannel } from '../reducers/channelReducer';\r\n\r\nconst CreateRoom = () => {\r\n  const [newUsername, setNewUsername] = useState('');\r\n  const [roomName, setRoomName] = useState('');\r\n  const titleClassName = 'font-bold text-xl mb-2';\r\n  const inputFieldClass = 'rounded-l shadow-sm border-r-0 border-gray-400 hover:bg-gray-100 hover:border-gray-500';\r\n  const buttonClass = 'focus:ring-2 shadow-sm px-3 py-2 border border-gray-400 hover:border-gray-500 rounded-r font-semibold focus:outline-none hover:bg-gray-200 focus:bg-gray-300';\r\n  const dispatch = useDispatch();\r\n  const user = useSelector((state) => state.activeUser);\r\n\r\n  // Creating a new channel and saving to DB\r\n  const handleChannelCreation = (event) => {\r\n    event.preventDefault();\r\n    dispatch(createChannel({ name: roomName, creator: user.username }));\r\n    setRoomName('');\r\n  };\r\n\r\n  // Saving a user in a localStorage for use with messages\r\n  const handleUserCreation = (event) => {\r\n    event.preventDefault();\r\n    dispatch(loginUser(newUsername));\r\n    setNewUsername('');\r\n  };\r\n\r\n  return (\r\n    <div className=\"md:grid md:grid-cols-5\">\r\n      <div className=\"mx-3 md:col-start-2 md:col-span-3 rounded shadow-sm border px-5 py-3 mt-5 text-center\">\r\n        {\r\n          user\r\n            ? (\r\n              <div>\r\n                Hello,\r\n                {' '}\r\n                {user.username}\r\n                !\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => dispatch(logoutUser())}\r\n                  className=\"px-2 py-1 mx-2 border hover:bg-gray-200 focus:outline-none focus:ring-2 border-gray-400 hover:border-gray-500 rounded shadow-sm font-semibold\"\r\n                >\r\n                  Logout\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <div>\r\n                <h1 className={titleClassName}>\r\n                  Enter your name\r\n                </h1>\r\n                <form onSubmit={handleUserCreation}>\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Enter your name...\"\r\n                    value={newUsername}\r\n                    onChange={({ target }) => setNewUsername(target.value)}\r\n                    className={inputFieldClass}\r\n                  />\r\n                  <button\r\n                    type=\"submit\"\r\n                    className={buttonClass}\r\n                  >\r\n                    Set\r\n                  </button>\r\n                </form>\r\n              </div>\r\n            )\r\n        }\r\n        <h2 className={titleClassName}>Create a new room or join existing</h2>\r\n        {\r\n          user\r\n            ? (\r\n              <form onSubmit={handleChannelCreation}>\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Enter room name\"\r\n                  value={roomName}\r\n                  onChange={({ target }) => setRoomName(target.value)}\r\n                  className={inputFieldClass}\r\n                />\r\n                <button\r\n                  type=\"submit\"\r\n                  className={buttonClass}\r\n                >\r\n                  Create\r\n                </button>\r\n              </form>\r\n            ) : (\r\n              'Login to create and join rooms!'\r\n            )\r\n        }\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CreateRoom;\r\n","import React, { useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Link } from 'react-router-dom';\r\nimport { initializeChannels } from '../reducers/channelReducer';\r\n\r\nconst ChannelList = () => {\r\n  const channels = useSelector((state) => state.channels);\r\n  const dispatch = useDispatch();\r\n\r\n  // On page load getting list of channels from server\r\n  useEffect(() => {\r\n    dispatch(initializeChannels());\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  // Redux state can be array of channels or a single channel and here we need a single channel\r\n  if (!Array.isArray(channels)) {\r\n    return ('loading...');\r\n  }\r\n\r\n  return (\r\n    <div className=\"md:grid md:grid-cols-5\">\r\n      <div className=\"mx-3 md:col-start-2 md:col-span-3 shadow-sm border rounded px-5 py-3 mt-5 text-center\">\r\n        <h2 className=\"font-bold text-xl mb-2\">\r\n          List of channels available\r\n        </h2>\r\n        {\r\n          channels\r\n            ? (\r\n              <ul>\r\n                {channels.map((c) => (\r\n                  <Link key={c.id} to={`/channels/${c.id}`}>\r\n                    <li className=\"border-gray-400 hover:border-gray-600 font-semibold border-2 rounded shadow-sm p-5 mb-3 bg-gray-50 hover:bg-gray-200\">\r\n                      {c.name}\r\n                    </li>\r\n                  </Link>\r\n                ))}\r\n              </ul>\r\n            ) : (\r\n              'Loading...'\r\n            )\r\n        }\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChannelList;\r\n","const mobileReducer = (state = false, action) => {\r\n  switch (action.type) {\r\n  case 'SET_OPENED':\r\n    return true;\r\n  case 'SET_CLOSED':\r\n    return false;\r\n  default:\r\n    return state;\r\n  }\r\n};\r\n\r\nexport const openMobileNavbar = () => ({\r\n  type: 'SET_OPENED',\r\n});\r\n\r\nexport const closeMobileNavbar = () => ({\r\n  type: 'SET_CLOSED',\r\n});\r\n\r\nexport default mobileReducer;\r\n","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { NavLink } from 'react-router-dom';\r\nimport { logoutUser } from '../reducers/userReducer';\r\nimport { openMobileNavbar, closeMobileNavbar } from '../reducers/mobileReducer';\r\n\r\nconst navLink = 'text-white px-2 hover:text-yellow-100 text-m';\r\nconst navLinkMobile = 'text-white hover:text-yellow-600 min-w-full hover:bg-gray-100 hover:opacity-50 block px-3 py-2 rounded-md text-base font-medium';\r\n\r\nconst MenuMobileButton = () => {\r\n  const dispatch = useDispatch();\r\n  const opened = useSelector((state) => state.mobileNavOpened);\r\n  console.log('OPEND:', opened);\r\n  const handleOpened = () => {\r\n    if (opened) {\r\n      return dispatch(closeMobileNavbar());\r\n    }\r\n    return dispatch(openMobileNavbar());\r\n  };\r\n\r\n  return (\r\n    <div className=\"-mr-2 flex justify-end items-end md:hidden\">\r\n      {/* <!-- Mobile menu button --> */}\r\n      <button\r\n        type=\"button\"\r\n        className=\"bg-green-300 mb-2 inline-flex items-end justify-end p-2 rounded-md text-gray-400 hover:text-white hover:bg-green-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white\"\r\n        aria-controls=\"mobile-menu\"\r\n        onClick={handleOpened}\r\n      >\r\n        {\r\n          opened\r\n            ? (\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" stroke=\"currentColor\" className=\"block h-6 w-6\" viewBox=\"0 0 16 16\">\r\n                <path d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z\" />\r\n                <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\" />\r\n              </svg>\r\n            ) : (\r\n              <svg className=\"block h-6 w-6\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" aria-hidden=\"true\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M4 6h16M4 12h16M4 18h16\" />\r\n              </svg>\r\n            )\r\n        }\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst MobileNavbar = () => {\r\n  const user = useSelector((state) => state.activeUser);\r\n  const dispatch = useDispatch();\r\n  const opened = useSelector((state) => state.mobileNavOpened);\r\n\r\n  return (\r\n    <div className=\"px-5\">\r\n      <MenuMobileButton />\r\n      <div className=\"flex flex-wrap text-center mx-auto justify-items-center space-y-1\">\r\n        {\r\n          opened\r\n            ? (\r\n              <>\r\n                <NavLink to=\"/new-channel\" activeClassName=\"font-bold\" className={navLinkMobile}>New channel</NavLink>\r\n                {/* Conditionally rendering the link to login */}\r\n                {\r\n                  user\r\n                    ? (\r\n                      <>\r\n                        <NavLink to=\"/channels/all\" activeClassName=\"font-bold\" className={navLinkMobile}>All channels</NavLink>\r\n                        <div className=\"flex justify-items-end items-end\">\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={() => dispatch(logoutUser())}\r\n                            className=\" text-right px-3 inline-flex self-end justify-end py-1 shadow-sm text-sm font-medium rounded-md text-white bg-orange-400 hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500\"\r\n                          >\r\n                            Logout\r\n                          </button>\r\n                        </div>\r\n                      </>\r\n                    )\r\n                    : (\r\n                      <NavLink to=\"/new-channel\" activeClassName=\"font-bold\" className={navLinkMobile}>Login</NavLink>\r\n                    )\r\n                }\r\n\r\n              </>\r\n            )\r\n            : ('')\r\n        }\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Navbar = () => {\r\n  const user = useSelector((state) => state.activeUser);\r\n  const dispatch = useDispatch();\r\n\r\n  return (\r\n    <div className=\"bg-blue-500 py-4\">\r\n      <div className=\"flex justify-end space-x-4\">\r\n        <div className=\"hidden md:block px-10\">\r\n          <NavLink to=\"/new-channel\" activeClassName=\"font-bold\" className={navLink}>New channel</NavLink>\r\n          {/* Conditionally rendering the link to login */}\r\n          {\r\n            user\r\n              ? (\r\n                <>\r\n                  <NavLink to=\"/channels/all\" activeClassName=\"font-bold\" className={navLink}>All channels</NavLink>\r\n                  <span className=\"text-white mr-2\">\r\n                    Hello,\r\n                    {' '}\r\n                    {user.username}\r\n                    !\r\n                  </span>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => dispatch(logoutUser())}\r\n                    className=\"px-3 py-1 mx-2 shadow-sm text-sm font-medium rounded-md text-white bg-orange-400 hover:bg-orange-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500\"\r\n                  >\r\n                    Logout\r\n                  </button>\r\n                </>\r\n              )\r\n              : <NavLink to=\"/new-channel\" activeClassName=\"font-bold\" className=\"px-3 py-1 mx-2 shadow-sm text-sm font-medium rounded-md text-white bg-green-500 hover:bg-green-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500\">Login</NavLink>\r\n          }\r\n        </div>\r\n      </div>\r\n      <div className=\"md:hidden ml-0\">\r\n        <MobileNavbar />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Navbar;\r\n","import React from 'react';\r\n\r\nconst NotFound = () => (\r\n  <div>\r\n    <h1>Error 404. Page not found!</h1>\r\n  </div>\r\n);\r\n\r\nexport default NotFound;\r\n","import React, { useEffect } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { Switch, Route, Redirect } from 'react-router-dom';\r\nimport ChatRoom from './components/ChatRoom';\r\nimport CreateRoom from './components/CreateRoom';\r\nimport ChannelList from './components/ChannelList';\r\nimport Navbar from './components/Navbar';\r\nimport NotFound from './components/NotFound';\r\nimport { initializeUser } from './reducers/userReducer';\r\n\r\nconst App = () => {\r\n  const dispatch = useDispatch();\r\n\r\n  // Getting the logged in user\r\n  useEffect(() => {\r\n    dispatch(initializeUser());\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <Navbar />\r\n      <Switch>\r\n        <Route exact path=\"/channels/all\" component={ChannelList} />\r\n        <Route path=\"/channels/:roomId\">\r\n          <ChatRoom />\r\n        </Route>\r\n        <Route exact path=\"/new-channel\" component={CreateRoom} />\r\n        <Route exact path=\"/\">\r\n          <Redirect to=\"/new-channel\" />\r\n        </Route>\r\n        <Route path=\"*\" component={NotFound} />\r\n      </Switch>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import { createStore, combineReducers, applyMiddleware } from 'redux';\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\nimport thunk from 'redux-thunk';\r\nimport userReducer from './reducers/userReducer';\r\nimport channelReducer from './reducers/channelReducer';\r\nimport mobileReducer from './reducers/mobileReducer';\r\n\r\nconst reducer = combineReducers({\r\n  activeUser: userReducer,\r\n  channels: channelReducer,\r\n  mobileNavOpened: mobileReducer,\r\n});\r\n\r\nconst store = createStore(reducer,\r\n  composeWithDevTools(applyMiddleware(thunk)));\r\n\r\nexport default store;\r\n","import React from 'react';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport './index.css';\r\nimport App from './App';\r\nimport store from './store';\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <Router>\r\n      <React.StrictMode>\r\n        <App />\r\n      </React.StrictMode>\r\n    </Router>\r\n  </Provider>,\r\n  document.getElementById('root'),\r\n);\r\n"],"sourceRoot":""}